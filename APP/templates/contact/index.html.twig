{% extends 'base_logged_in.html.twig' %}

{% block title %}{{ 'contact.list'|trans }}{% endblock %}

{% block logged_in_content %}
    <h2 class="c-grey-900" style="margin-bottom: 10px;">
        {{ 'contact.list'|trans }}
        <div class="float-end">
            <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#contactFormModal"
                    data-contact-action="new">
                {{ 'create_new'|trans }}
            </button>
        </div>
    </h2>

    {% for label, messages in app.flashes(['success', 'danger', 'warning', 'info']) %}
        {% for message in messages %}
            <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                {{ message|trans }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endfor %}

    <!-- Filter Block -->
    <div class="bgc-white p-20 bd mb-3" id="contact-filter-block">
        <div class="d-flex align-items-center gap-3">
            <label class="mb-0 fw-bold">{{ 'contact.filter_by_category'|trans|default('Filter nach Kategorie:') }}</label>
            <div class="d-flex gap-2 flex-wrap" id="category-filter-buttons">
                {% for category in contact_categories %}
                    <button
                        type="button"
                        class="btn btn-outline-primary category-filter-btn"
                        data-category-id="{{ category.id }}"
                        {% if category.id in selected_category_ids %}data-selected="1"{% endif %}
                    >
                        {{ category.name }}
                    </button>
                {% endfor %}
                {% if contact_categories|length > 0 %}
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="clear-filters">
                        {{ 'clear'|trans|default('Alle anzeigen') }}
                    </button>
                {% endif %}
            </div>
        </div>
    </div>

    {% include 'contact/_contacts_list.html.twig' %}

{% endblock %}
