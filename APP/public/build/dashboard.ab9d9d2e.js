(self.webpackChunk=self.webpackChunk||[]).push([[945],{35358:(e,t,n)=>{var a={"./af":25177,"./af.js":25177,"./ar":61509,"./ar-dz":41488,"./ar-dz.js":41488,"./ar-kw":58676,"./ar-kw.js":58676,"./ar-ly":42353,"./ar-ly.js":42353,"./ar-ma":24496,"./ar-ma.js":24496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":82682,"./ar-sa.js":82682,"./ar-tn":89756,"./ar-tn.js":89756,"./ar.js":61509,"./az":95533,"./az.js":95533,"./be":28959,"./be.js":28959,"./bg":47777,"./bg.js":47777,"./bm":54903,"./bm.js":54903,"./bn":61290,"./bn-bd":17357,"./bn-bd.js":17357,"./bn.js":61290,"./bo":31545,"./bo.js":31545,"./br":11470,"./br.js":11470,"./bs":44429,"./bs.js":44429,"./ca":7306,"./ca.js":7306,"./cs":56464,"./cs.js":56464,"./cv":73635,"./cv.js":73635,"./cy":64226,"./cy.js":64226,"./da":93601,"./da.js":93601,"./de":77853,"./de-at":26111,"./de-at.js":26111,"./de-ch":54697,"./de-ch.js":54697,"./de.js":77853,"./dv":60708,"./dv.js":60708,"./el":54691,"./el.js":54691,"./en-au":53872,"./en-au.js":53872,"./en-ca":28298,"./en-ca.js":28298,"./en-gb":56195,"./en-gb.js":56195,"./en-ie":66584,"./en-ie.js":66584,"./en-il":65543,"./en-il.js":65543,"./en-in":9033,"./en-in.js":9033,"./en-nz":79402,"./en-nz.js":79402,"./en-sg":43004,"./en-sg.js":43004,"./eo":32934,"./eo.js":32934,"./es":97650,"./es-do":20838,"./es-do.js":20838,"./es-mx":17730,"./es-mx.js":17730,"./es-us":56575,"./es-us.js":56575,"./es.js":97650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":90527,"./fi.js":90527,"./fil":95995,"./fil.js":95995,"./fo":52477,"./fo.js":52477,"./fr":85498,"./fr-ca":26435,"./fr-ca.js":26435,"./fr-ch":37892,"./fr-ch.js":37892,"./fr.js":85498,"./fy":37071,"./fy.js":37071,"./ga":41734,"./ga.js":41734,"./gd":70217,"./gd.js":70217,"./gl":77329,"./gl.js":77329,"./gom-deva":32124,"./gom-deva.js":32124,"./gom-latn":93383,"./gom-latn.js":93383,"./gu":95050,"./gu.js":95050,"./he":11713,"./he.js":11713,"./hi":43861,"./hi.js":43861,"./hr":26308,"./hr.js":26308,"./hu":90609,"./hu.js":90609,"./hy-am":17160,"./hy-am.js":17160,"./id":74063,"./id.js":74063,"./is":89374,"./is.js":89374,"./it":88383,"./it-ch":21827,"./it-ch.js":21827,"./it.js":88383,"./ja":23827,"./ja.js":23827,"./jv":89722,"./jv.js":89722,"./ka":41794,"./ka.js":41794,"./kk":27088,"./kk.js":27088,"./km":96870,"./km.js":96870,"./kn":84451,"./kn.js":84451,"./ko":63164,"./ko.js":63164,"./ku":98174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":98174,"./ky":78474,"./ky.js":78474,"./lb":79680,"./lb.js":79680,"./lo":15867,"./lo.js":15867,"./lt":45766,"./lt.js":45766,"./lv":69532,"./lv.js":69532,"./me":58076,"./me.js":58076,"./mi":41848,"./mi.js":41848,"./mk":30306,"./mk.js":30306,"./ml":73739,"./ml.js":73739,"./mn":99053,"./mn.js":99053,"./mr":86169,"./mr.js":86169,"./ms":73386,"./ms-my":92297,"./ms-my.js":92297,"./ms.js":73386,"./mt":77075,"./mt.js":77075,"./my":72264,"./my.js":72264,"./nb":22274,"./nb.js":22274,"./ne":8235,"./ne.js":8235,"./nl":92572,"./nl-be":43784,"./nl-be.js":43784,"./nl.js":92572,"./nn":54566,"./nn.js":54566,"./oc-lnc":69330,"./oc-lnc.js":69330,"./pa-in":29849,"./pa-in.js":29849,"./pl":94418,"./pl.js":94418,"./pt":79834,"./pt-br":48303,"./pt-br.js":48303,"./pt.js":79834,"./ro":24457,"./ro.js":24457,"./ru":82271,"./ru.js":82271,"./sd":1221,"./sd.js":1221,"./se":33478,"./se.js":33478,"./si":17538,"./si.js":17538,"./sk":5784,"./sk.js":5784,"./sl":46637,"./sl.js":46637,"./sq":86794,"./sq.js":86794,"./sr":45719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":45719,"./ss":56e3,"./ss.js":56e3,"./sv":41011,"./sv.js":41011,"./sw":40748,"./sw.js":40748,"./ta":11025,"./ta.js":11025,"./te":11885,"./te.js":11885,"./tet":28861,"./tet.js":28861,"./tg":86571,"./tg.js":86571,"./th":55802,"./th.js":55802,"./tk":59527,"./tk.js":59527,"./tl-ph":29231,"./tl-ph.js":29231,"./tlh":31052,"./tlh.js":31052,"./tr":85096,"./tr.js":85096,"./tzl":79846,"./tzl.js":79846,"./tzm":81765,"./tzm-latn":97711,"./tzm-latn.js":97711,"./tzm.js":81765,"./ug-cn":48414,"./ug-cn.js":48414,"./uk":16618,"./uk.js":16618,"./ur":57777,"./ur.js":57777,"./uz":57609,"./uz-latn":72475,"./uz-latn.js":72475,"./uz.js":57609,"./vi":21135,"./vi.js":21135,"./x-pseudo":64051,"./x-pseudo.js":64051,"./yo":82218,"./yo.js":82218,"./zh-cn":52648,"./zh-cn.js":52648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":31541,"./zh-mo.js":31541,"./zh-tw":50304,"./zh-tw.js":50304};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=35358},41661:(e,t,n)=>{"use strict";n.d(t,{Hs:()=>g,IQ:()=>j,qR:()=>E});n(52675),n(89463),n(2259),n(45700),n(16280),n(76918),n(2008),n(51629),n(23792),n(44114),n(89572),n(2892),n(67945),n(84185),n(83851),n(81278),n(79432),n(26099),n(47764),n(73772),n(98992),n(54520),n(3949),n(23500),n(62953);var a=n(95093),i=n.n(a),r=(n(77853),n(43335)),o=n.n(r),c=n(74692);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}if(i().locale("de"),void 0!==c&&c.fn.modal){var m=c.fn.modal.Constructor.prototype._enforceFocus;c.fn.modal.Constructor.prototype._enforceFocus=function(){document.querySelector(".daterangepicker:not(.show-calendar)")||m.call(this)}}var v={locale:{format:"DD.MM.YYYY",separator:" - ",applyLabel:"Übernehmen",cancelLabel:"Abbrechen",fromLabel:"Von",toLabel:"Bis",customRangeLabel:"Benutzerdefiniert",weekLabel:"W",daysOfWeek:i().weekdaysMin(),monthNames:i().months(),firstDay:1},autoUpdateInput:!0,showDropdowns:!0,autoApply:!1},p={singleDate:d(d({},v),{},{singleDatePicker:!0,timePicker:!1,locale:d(d({},v.locale),{},{format:"DD.MM.YYYY"})}),singleDateTime:d(d({},v),{},{singleDatePicker:!0,timePicker:!0,timePicker24Hour:!0,timePickerIncrement:15,locale:d(d({},v.locale),{},{format:"DD.MM.YYYY HH:mm"})}),dateRange:d(d({},v),{},{singleDatePicker:!1,timePicker:!1,locale:d(d({},v.locale),{},{format:"DD.MM.YYYY"})}),dateTimeRange:d(d({},v),{},{singleDatePicker:!1,timePicker:!0,timePicker24Hour:!0,timePickerIncrement:15,locale:d(d({},v.locale),{},{format:"DD.MM.YYYY HH:mm"})})},h=new WeakMap;function f(e){var t=h.get(e);if(t&&"function"==typeof t.remove)try{t.remove()}catch(e){console.warn("Error destroying picker:",e)}h.delete(e)}function b(e){var t=e.closest(".modal");if(t)return t;var n=e.closest(".offcanvas");if(n)return n;var a=e.closest(".container, .container-fluid, form");return a||"body"}function y(e,t){return d(d({},e),{},{parentEl:b(t)})}function g(){document.querySelectorAll(".modal").forEach(function(e){e.setAttribute("data-focus","false"),e.setAttribute("data-bs-focus","false")}),new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){1===e.nodeType&&e.classList&&e.classList.contains("modal")&&(e.setAttribute("data-focus","false"),e.setAttribute("data-bs-focus","false"))})})}).observe(document.body,{childList:!0,subtree:!0}),document.querySelectorAll('[data-daterangepicker="single-date"]').forEach(function(e){f(e);var t=y(p.singleDate,e),n=new(o())(e,t);h.set(e,n),k(n)}),document.querySelectorAll('[data-daterangepicker="single-datetime"]').forEach(function(e){f(e);var t=y(p.singleDateTime,e),n=new(o())(e,t);h.set(e,n),k(n)}),document.querySelectorAll('[data-daterangepicker="date-range"]').forEach(function(e){f(e);var t=y(p.dateRange,e),n=new(o())(e,t);h.set(e,n),k(n)}),document.querySelectorAll('[data-daterangepicker="datetime-range"]').forEach(function(e){f(e);var t=y(p.dateTimeRange,e),n=new(o())(e,t);h.set(e,n),k(n)})}function k(e){if(e&&e.container){var t=e.container[0]||e.container.get(0);if(t)t.setAttribute("tabindex","-1"),t.addEventListener("mousedown",function(e){e.stopPropagation()},!0),t.addEventListener("focusin",function(e){e.stopPropagation()},!0),t.querySelectorAll("select").forEach(function(e){e.addEventListener("mousedown",function(e){e.stopPropagation()},!0),e.addEventListener("click",function(e){e.stopPropagation()},!0)})}}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dateTimeRange",n="string"==typeof e?document.querySelector(e):e;if(!n)return console.warn("Daterangepicker: Element not found",e),null;f(n);var a=new(o())(n,p[t]);return h.set(n,a),a}function j(e){var t="string"==typeof e?document.querySelector(e):e;return h.get(t)}},70001:(e,t,n)=>{"use strict";n(52675),n(89463),n(2259),n(16280),n(76918),n(28706),n(2008),n(50113),n(51629),n(23418),n(74423),n(64346),n(23792),n(48598),n(62062),n(44114),n(34782),n(59089),n(1688),n(60739),n(23288),n(62010),n(33110),n(5506),n(26099),n(3362),n(27495),n(90906),n(38781),n(21699),n(47764),n(11392),n(50375),n(98992),n(54520),n(72577),n(3949),n(81454),n(23500),n(62953),n(76031),n(47154);var a=n(67363),i=n(97950),r=n(90666),o=n(38680),c=n(39612),s=n(89336),l=n(95093),d=n.n(l),u=n(41661);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r,o,c=[],s=!0,l=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=r.call(n)).done)&&(c.push(a.value),c.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var p,h,f,b,y=[],g=new Date,k=[],E=null,j="global",w={"#4285f4":"c-blue-500","#0f9d58":"c-green-500","#f4b400":"c-orange-500","#db4437":"c-red-500","#ab47bc":"c-purple-500","#00acc1":"c-cyan-500","#ff7043":"c-deep-orange-500","#9e9e9e":"c-grey-500"},D={bar:"Bar",setup:"Aufbau",teardown:"Abbau",ticketing:"Ticketing",cleanup:"Aufräumen",other:"Anderes"};function T(e,t){var n=document.getElementById("day-events-list");if(n){var a=new Date(e);a.setHours(0,0,0,0);var i=t.filter(function(e){var t=new Date(e.start);t.setHours(0,0,0,0);var n=e.end?new Date(e.end):new Date(e.start);return n.setHours(0,0,0,0),t.getTime()<=a.getTime()&&n.getTime()>=a.getTime()});if(0===i.length)n.innerHTML='\n            <li class="bdB peers ai-c jc-sb fxw-nw p-20">\n                <div class="c-grey-600">\n                    <span>Keine Termine an diesem Tag</span>\n                </div>\n            </li>\n        ';else{var r=new Date;n.innerHTML=i.map(function(e){var t=e.color||e.backgroundColor||"#4285f4",n=w[t]||"c-blue-500",a=e.start&&!e.allDay?new Date(e.start).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit",hour12:!1}):"",i=new Date(e.start).toLocaleDateString("de-DE",{day:"2-digit",month:"short"}),o=(e.end?new Date(e.end):new Date(e.start))<r,c=o?'style="text-decoration: line-through;"':"";return'\n                <li class="bdB peers ai-c jc-sb fxw-nw" '.concat(o?'style="opacity: 0.5;"':"",'>\n                    <a class="td-n p-20 peers fxw-nw mR-20 peer-greed c-grey-900 event-item"\n                       href="javascript:void(0);"\n                       data-event-id="').concat(e.id,'">\n                        <div class="peer mR-15">\n                            <i class="fa fa-fw fa-clock-o ').concat(n,'"></i>\n                        </div>\n                        <div class="peer">\n                            <span class="fw-600" ').concat(c,">").concat(e.title,'</span>\n                            <div class="c-grey-600">\n                                <span class="c-grey-700">').concat(i).concat(a?" - "+a+" Uhr":"","</span>\n                                ").concat(e.allDay?'<i class="mL-5">(Ganztägig)</i>':"","\n                                ").concat(e.description?"<br><i>"+e.description+"</i>":"","\n                            </div>\n                        </div>\n                    </a>\n                    ").concat(e.extendedProps&&["private","cleaning","production"].includes(e.extendedProps.type)?'\n                    <div class="peers mR-15">\n                        <div class="peer">\n                            <a href="javascript:void(0);"\n                               class="td-n c-deep-purple-500 cH-blue-500 fsz-md p-5 edit-event"\n                               data-event-id="'.concat(e.id,'">\n                                <i class="ti-pencil"></i>\n                            </a>\n                        </div>\n                        <div class="peer">\n                            <a href="javascript:void(0);"\n                               class="td-n c-red-500 cH-blue-500 fsz-md p-5 delete-event"\n                               data-event-id="').concat(e.id,'">\n                                <i class="ti-trash"></i>\n                            </a>\n                        </div>\n                    </div>'):"","\n                </li>\n            ")}).join(""),n.querySelectorAll(".event-item, .edit-event").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("data-event-id"),n=y.find(function(e){return e.id==t});n&&R(null,n)})}),n.querySelectorAll(".delete-event").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),F(this.getAttribute("data-event-id"))})})}}}var I=null;function S(){var e=document.getElementById("appointmentModal");e&&(p=new s.aF(e));var t=document.getElementById("productionEventModal");t&&(h=new s.aF(t));var n=document.getElementById("deleteConfirmModal");n&&(b=new s.aF(n)),k.forEach(function(e){return e.destroy()}),k=[],E&&(E.destroy(),E=null),document.querySelectorAll(".filter-checkbox").forEach(function(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("change",L)}),document.querySelectorAll('input[name="calendarView"]').forEach(function(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("change",function(){var e,t,n;j=this.value,e=this.value,t=document.getElementById("globalCalendarContainer"),n=document.getElementById("roomCalendarsContainer"),"global"===e?(t&&(t.style.display="block"),n&&(n.style.display="none"),E&&(E.updateSize(),E.refetchEvents())):(t&&(t.style.display="none"),n&&(n.style.display="block"),k.forEach(function(e){e.updateSize(),e.refetchEvents()}))})});var l=document.getElementById("syncApiBtn");if(l){var d=l.cloneNode(!0);l.parentNode.replaceChild(d,l),d.addEventListener("click",B)}var u=window.innerWidth<=767;!function(e){var t=document.getElementById("global-calendar");if(!t)return;E=new a.Vv(t,{plugins:[i.A,r.A,o.Ay],initialView:e?"timeGridWeek":"dayGridMonth",locale:c.A,timeZone:"Europe/Berlin",firstDay:1,headerToolbar:e?{left:"prev,next",center:"title",right:"today,dayGridMonth,timeGridWeek,timeGridDay"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},slotMinTime:"08:00:00",slotMaxTime:"22:00:00",allDaySlot:!0,height:1e3,eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!1,meridiem:!1},eventDisplay:"block",events:function(e,t,n){var a=Array.from(document.querySelectorAll(".filter-checkbox:checked")).map(function(e){return e.value}).join(","),i="/dashboard/events?roomId=&start=".concat(e.startStr,"&end=").concat(e.endStr,"&filters=").concat(a);fetch(i).then(function(e){return e.json()}).then(function(e){return t(e)}).catch(function(e){console.error("Error loading events:",e),n(e)})},dateClick:function(e){R(e.dateStr,null,e.date,null)},eventClick:function(e){A(e)},eventDidMount:function(e){var t=new Date;(e.event.end||e.event.start)<t&&(e.el.style.opacity="0.5",e.el.style.textDecoration="line-through")},editable:!1}),E.render()}(u),function(e){document.querySelectorAll(".room-calendar").forEach(function(t){var n=function(e,t){var n=e.dataset.roomId||"",s=new a.Vv(e,{plugins:[i.A,r.A,o.Ay],initialView:t?"timeGridWeek":"dayGridMonth",locale:c.A,timeZone:"Europe/Berlin",firstDay:1,headerToolbar:t?{left:"prev,next",center:"title",right:"today,dayGridMonth,timeGridWeek,timeGridDay"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},slotMinTime:"08:00:00",slotMaxTime:"22:00:00",allDaySlot:!0,height:1e3,eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!1,meridiem:!1},eventDisplay:"block",events:function(e,t,a){var i=Array.from(document.querySelectorAll(".filter-checkbox:checked")).map(function(e){return e.value}).join(","),r="/dashboard/events?roomId=".concat(n,"&start=").concat(e.startStr,"&end=").concat(e.endStr,"&filters=").concat(i);fetch(r).then(function(e){return e.json()}).then(function(e){return t(e)}).catch(function(e){console.error("Error loading events:",e),a(e)})},dateClick:function(e){R(e.dateStr,null,e.date,n)},eventClick:function(e){A(e)},eventDidMount:function(e){var t=new Date;(e.event.end||e.event.start)<t&&(e.el.style.opacity="0.5",e.el.style.textDecoration="line-through")},editable:!1,datesSet:function(e){!function(e){if(e._isSyncing)return;k.forEach(function(t){if(t!==e){t._isSyncing=!0;var n=e.view.type,a=e.getDate();t.view.type!==n&&t.changeView(n),t.gotoDate(a),setTimeout(function(){t._isSyncing=!1},100)}})}(s)}});return s.render(),s}(t,e);k.push(n)})}(u),fetch("/appointments/all").then(function(e){return e.json()}).then(function(e){y=e,function(e){g=new Date(e);var t=e.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}),n=e.toLocaleDateString("de-DE",{weekday:"long"}),a=document.getElementById("day-number-text");a&&(a.textContent=t);var i=document.getElementById("day-suffix");i&&(i.textContent="");var r=document.getElementById("day-name");r&&(r.textContent=n.charAt(0).toUpperCase()+n.slice(1))}(g),T(g,e)}).catch(function(e){return console.error(e)}),function(){var e=document.getElementById("saveAppointmentBtn");if(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("click",H)}var n=document.getElementById("deleteAppointmentBtn");if(n){var a=n.cloneNode(!0);n.parentNode.replaceChild(a,n),a.addEventListener("click",function(){F(document.getElementById("appointmentId").value)})}var i=document.getElementById("confirmDeleteBtn");if(i){var r=i.cloneNode(!0);i.parentNode.replaceChild(r,i),r.addEventListener("click",_)}var o=document.getElementById("appointmentAllDay");if(o){var c=o.cloneNode(!0);o.parentNode.replaceChild(c,o),c.addEventListener("change",z)}var s=document.getElementById("appointmentRecurring");if(s){var l=s.cloneNode(!0);s.parentNode.replaceChild(l,s),l.addEventListener("change",P)}document.querySelectorAll(".appointment-type-radio").forEach(function(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("change",C)});var d=document.getElementById("add-appointment-btn");if(d){var u=d.cloneNode(!0);d.parentNode.replaceChild(u,d),u.addEventListener("click",function(){R(g.toISOString().split("T")[0])})}}()}function B(){var e=document.getElementById("syncApiBtn");if(e){var t=e.innerHTML;e.disabled=!0,e.innerHTML='<i class="ti-reload spin"></i> Synchronisiere...';var n=document.createElement("style");n.textContent="\n        .spin {\n            animation: spin 1s linear infinite;\n        }\n        @keyframes spin {\n            from { transform: rotate(0deg); }\n            to { transform: rotate(360deg); }\n        }\n    ",document.querySelector("style[data-sync-spinner]")||(n.setAttribute("data-sync-spinner","true"),document.head.appendChild(n)),fetch("/dashboard/sync-api",{method:"POST",headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(n){e.disabled=!1,e.innerHTML=t,n.success?(x("success",n.message),L(),fetch("/appointments/all").then(function(e){return e.json()}).then(function(e){y=e,T(g,e)})):x("error",n.message||"Fehler bei der Synchronisation")}).catch(function(n){e.disabled=!1,e.innerHTML=t,console.error("Sync error:",n),x("error","Netzwerkfehler bei der Synchronisation")})}}function x(e,t){var n=document.createElement("div");n.className="alert alert-".concat("success"===e?"success":"danger"," alert-dismissible fade show position-fixed"),n.style.cssText="top: 20px; right: 20px; z-index: 9999; max-width: 400px;",n.innerHTML="\n        ".concat(t,'\n        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n    '),document.body.appendChild(n),setTimeout(function(){n.remove()},5e3)}function L(){"global"===j?E&&E.refetchEvents():k.forEach(function(e){return e.refetchEvents()})}function M(){L()}function A(e){var t=e.event.extendedProps.type;if("production_event"===t){var n=e.event.extendedProps.productionEventId;n&&function(e){var t=document.getElementById("productionEventModalBody"),n=document.getElementById("productionEventModalTitle"),a=document.getElementById("editProductionEventBtn");if(!h)return;t.innerHTML='\n        <div class="text-center p-5">\n            <div class="spinner-border text-primary" role="status">\n                <span class="visually-hidden">Laden...</span>\n            </div>\n        </div>\n    ',h.show(),fetch("/dashboard/production-event/".concat(e,"/details")).then(function(e){return e.json()}).then(function(e){if(e.error)t.innerHTML='<div class="alert alert-danger">'.concat(e.error,"</div>");else{var i=e.event,r=e.production;n.textContent=r?r.title:"Veranstaltung",a&&(a.href="/production-event/".concat(i.id,"/edit"),a.style.display="inline-block");var o="";if(r&&r.postThumbnailUrl&&(o+='\n                    <div class="text-center mb-4">\n                        <img src="'.concat(r.postThumbnailUrl,'"\n                             alt="').concat(r.title,'"\n                             class="img-fluid rounded"\n                             style="max-height: 300px; object-fit: cover;">\n                    </div>\n                ')),o+='<div class="row mb-4">',o+='<div class="col-md-6">',o+='<h6 class="text-muted mb-3">Veranstaltungsinformationen</h6>',i.date&&(o+='\n                    <div class="mb-2">\n                        <strong><i class="ti-calendar me-2"></i>Datum:</strong>\n                        '.concat(i.date,"\n                    </div>\n                ")),i.timeFrom&&(o+='\n                    <div class="mb-2">\n                        <strong><i class="ti-time me-2"></i>Uhrzeit:</strong>\n                        '.concat(i.timeFrom).concat(i.timeTo?" - "+i.timeTo:""," Uhr\n                    </div>\n                ")),i.room&&(o+='\n                    <div class="mb-2">\n                        <strong><i class="ti-location-pin me-2"></i>Raum:</strong>\n                        '.concat(i.room,"\n                    </div>\n                ")),i.status){var c=i.status.includes("Aktiv")?"success":"secondary";o+='\n                    <div class="mb-2">\n                        <strong>Status:</strong>\n                        <span class="badge bg-'.concat(c,'">').concat(i.status,"</span>\n                    </div>\n                ")}if(o+="</div>",o+='<div class="col-md-6">',o+='<h6 class="text-muted mb-3">Plätze & Reservierungen</h6>',null!==i.quota&&(o+='\n                    <div class="mb-2">\n                        <strong><i class="ti-package me-2"></i>Kontingent:</strong>\n                        '.concat(i.quota," Plätze\n                    </div>\n                ")),null!==i.incomingTotal&&(o+='\n                    <div class="mb-2">\n                        <strong><i class="ti-check me-2"></i>Reserviert:</strong>\n                        '.concat(i.incomingTotal,"\n                    </div>\n                ")),null!==i.freeSeats){var s=i.freeSeats>10?"success":i.freeSeats>0?"warning":"danger";o+='\n                    <div class="mb-2">\n                        <strong><i class="ti-ticket me-2"></i>Frei:</strong>\n                        <span class="badge bg-'.concat(s,'">').concat(i.freeSeats,"</span>\n                    </div>\n                ")}if(o+="</div>",o+="</div>",i.prices&&i.prices.length>0&&(o+='\n                    <div class="mb-4">\n                        <h6 class="text-muted mb-3">Preise</h6>\n                        <div class="table-responsive">\n                            <table class="table table-sm table-bordered">\n                                <thead class="table-light">\n                                    <tr>\n                                        <th>Kategorie</th>\n                                        <th>Preis</th>\n                                        <th>Reservierungen</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                ',i.prices.forEach(function(e){o+="\n                        <tr>\n                            <td>".concat(e.categoryLabel||"-","</td>\n                            <td><strong>").concat(e.priceLabel||"0","€</strong></td>\n                            <td>").concat(e.incomingReservations||0,"</td>\n                        </tr>\n                    ")}),o+="\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                "),i.categories&&i.categories.length>0&&(o+='\n                    <div class="mb-4">\n                        <h6 class="text-muted mb-2">Hinweise</h6>\n                        <div>\n                ',i.categories.forEach(function(e){var t="ausverkauft-event"===e.slug?"danger":"info";o+='<span class="badge bg-'.concat(t,' me-2">').concat(e.name,"</span>")}),o+="\n                        </div>\n                    </div>\n                "),i.reservationNote){var l=i.reservationNote.startsWith("http");o+='\n                    <div class="mb-4">\n                        <h6 class="text-muted mb-2">Reservierung</h6>\n                        '.concat(l?'<a href="'.concat(i.reservationNote,'" target="_blank" class="btn btn-sm btn-primary">\n                                <i class="ti-new-window me-1"></i>Zur Reservierung\n                            </a>'):'<p class="mb-0">'.concat(i.reservationNote,"</p>"),"\n                    </div>\n                ")}r&&r.contentHtml&&(o+='\n                    <div class="mt-4 pt-4 border-top">\n                        <h6 class="text-muted mb-3">Über die Produktion</h6>\n                        <div class="production-content">\n                            '.concat(r.contentHtml,"\n                        </div>\n                    </div>\n                ")),r&&r.permalink&&(o+='\n                    <div class="mt-3">\n                        <a href="'.concat(r.permalink,'" target="_blank" class="btn btn-sm btn-secondary">\n                            <i class="ti-link me-1"></i>Zur Website\n                        </a>\n                    </div>\n                ')),t.innerHTML=o}}).catch(function(e){console.error("Error loading event details:",e),t.innerHTML='\n                <div class="alert alert-danger">\n                    Fehler beim Laden der Event-Details.\n                </div>\n            '})}(n)}else if("key"===t){var a=e.event.extendedProps.keyId;a&&G(a)}else["private","cleaning","production"].includes(t)?R(null,e.event):alert(e.event.title+"\n"+(e.event.extendedProps.description||""))}function P(e){var t=document.getElementById("recurrenceOptions");t&&(t.style.display=e.target.checked?"block":"none")}function C(){var e=document.querySelector('input[name="appointmentType"]:checked');if(e){var t,n=e.value,a=document.getElementById("typeSpecificFields");if(a)switch(a.innerHTML="",n){case"private":case"school_event":case"internal":break;case"production":a.innerHTML=function(){var e=window.dashboardData.allProductions||[];window.dashboardData.allTechnicians,window.dashboardData.allVolunteers;return'\n        <div class="border-top pt-3 mt-3">\n            <h6 class="fw-bold mb-3">Produktions-Details</h6>\n\n            <div class="mb-3">\n                <label for="productionSelect" class="form-label">Produktion</label>\n                <select class="form-select" id="productionSelect">\n                    <option value="">Bitte wählen...</option>\n                    '.concat(e.map(function(e){return'<option value="'.concat(e.id,'">').concat(e.title||e.displayName,"</option>")}).join(""),'\n                </select>\n            </div>\n\n            <div class="mb-3">\n                <label class="form-label d-block">Ereignisart</label>\n                <div class="btn-group w-100" role="group">\n                    <input type="radio" class="btn-check" name="eventType" id="eventTypeRehearsal" value="rehearsal">\n                    <label class="btn btn-outline-secondary" for="eventTypeRehearsal">\n                        <i class="ti-music-alt"></i> Probe\n                    </label>\n\n                    <input type="radio" class="btn-check" name="eventType" id="eventTypeSetup" value="setup_teardown">\n                    <label class="btn btn-outline-secondary" for="eventTypeSetup">\n                        <i class="ti-package"></i> Aufbau/Abbau\n                    </label>\n\n                    <input type="radio" class="btn-check" name="eventType" id="eventTypeEvent" value="event">\n                    <label class="btn btn-outline-secondary" for="eventTypeEvent">\n                        <i class="ti-flag-alt"></i> Veranstaltung\n                    </label>\n                </div>\n            </div>\n\n            <div class="mb-3">\n                <label class="form-label">Status</label>\n                <div class="btn-group w-100" role="group">\n                    <input type="radio" class="btn-check" name="appointmentStatus" id="statusReserved" value="reserved">\n                    <label class="btn btn-outline-warning" for="statusReserved">Reserviert</label>\n\n                    <input type="radio" class="btn-check" name="appointmentStatus" id="statusConfirmed" value="confirmed">\n                    <label class="btn btn-outline-success" for="statusConfirmed">Fix</label>\n                </div>\n            </div>\n\n            <div class="mb-3 form-check">\n                <input type="checkbox" class="form-check-input" id="internalTechniciansAttending">\n                <label class="form-check-label" for="internalTechniciansAttending">\n                    Interne Techniker kommen\n                </label>\n            </div>\n\n            <div class="mb-3">\n                <div class="form-check">\n                    <input type="checkbox" class="form-check-input" id="assignTechniciansCheckbox">\n                    <label class="form-check-label fw-bold" for="assignTechniciansCheckbox">\n                        Techniker zuweisen\n                    </label>\n                </div>\n            </div>\n\n            <div id="techniciansContainer" style="display: none;">\n                <table class="table table-bordered table-sm">\n                    <thead>\n                        <tr>\n                            <th style="width: 50%;">Techniker</th>\n                            <th style="width: 25%;">Bestätigt</th>\n                            <th style="width: 25%;"></th>\n                        </tr>\n                    </thead>\n                    <tbody id="techniciansList">\n                    </tbody>\n                </table>\n                <button type="button" class="btn btn-sm btn-success" id="addTechnicianBtn">\n                    <i class="ti-plus"></i> Techniker hinzufügen\n                </button>\n            </div>\n\n            <div class="mb-3 mt-3">\n                <div class="form-check">\n                    <input type="checkbox" class="form-check-input" id="assignVolunteersCheckbox">\n                    <label class="form-check-label fw-bold" for="assignVolunteersCheckbox">\n                        Volunteers zuweisen\n                    </label>\n                </div>\n            </div>\n\n            <div id="volunteersContainer" style="display: none;">\n                <table class="table table-bordered table-sm">\n                    <thead>\n                        <tr>\n                            <th style="width: 35%;">Volunteer</th>\n                            <th style="width: 20%;">Bestätigt</th>\n                            <th style="width: 35%;">Aufgaben</th>\n                            <th style="width: 10%;"></th>\n                        </tr>\n                    </thead>\n                    <tbody id="volunteersList">\n                    </tbody>\n                </table>\n                <button type="button" class="btn btn-sm btn-success" id="addVolunteerBtn">\n                    <i class="ti-plus"></i> Volunteer hinzufügen\n                </button>\n            </div>\n        </div>\n    ')}(),Y();break;case"closed_event":a.innerHTML=function(){window.dashboardData.allTechnicians,window.dashboardData.allVolunteers;return'\n        <div class="border-top pt-3 mt-3">\n            <h6 class="fw-bold mb-3">Veranstaltungs-Details</h6>\n\n            <div class="mb-3">\n                <label class="form-label d-block">Ereignisart</label>\n                <div class="btn-group w-100" role="group">\n                    <input type="radio" class="btn-check" name="eventType" id="eventTypeRehearsal" value="rehearsal">\n                    <label class="btn btn-outline-secondary" for="eventTypeRehearsal">\n                        <i class="ti-music-alt"></i> Probe\n                    </label>\n\n                    <input type="radio" class="btn-check" name="eventType" id="eventTypeSetup" value="setup_teardown">\n                    <label class="btn btn-outline-secondary" for="eventTypeSetup">\n                        <i class="ti-package"></i> Aufbau/Abbau\n                    </label>\n\n                    <input type="radio" class="btn-check" name="eventType" id="eventTypeEvent" value="event">\n                    <label class="btn btn-outline-secondary" for="eventTypeEvent">\n                        <i class="ti-flag-alt"></i> Veranstaltung\n                    </label>\n                </div>\n            </div>\n\n            <div class="mb-3">\n                <label class="form-label">Status</label>\n                <div class="btn-group w-100" role="group">\n                    <input type="radio" class="btn-check" name="appointmentStatus" id="statusReserved" value="reserved">\n                    <label class="btn btn-outline-warning" for="statusReserved">Reserviert</label>\n\n                    <input type="radio" class="btn-check" name="appointmentStatus" id="statusConfirmed" value="confirmed">\n                    <label class="btn btn-outline-success" for="statusConfirmed">Fix</label>\n                </div>\n            </div>\n\n            <div class="mb-3 form-check">\n                <input type="checkbox" class="form-check-input" id="internalTechniciansAttending">\n                <label class="form-check-label" for="internalTechniciansAttending">\n                    Interne Techniker kommen\n                </label>\n            </div>\n\n            <div class="mb-3">\n                <div class="form-check">\n                    <input type="checkbox" class="form-check-input" id="assignTechniciansCheckbox">\n                    <label class="form-check-label fw-bold" for="assignTechniciansCheckbox">\n                        Techniker zuweisen\n                    </label>\n                </div>\n            </div>\n\n            <div id="techniciansContainer" style="display: none;">\n                <table class="table table-bordered table-sm">\n                    <thead>\n                        <tr>\n                            <th style="width: 50%;">Techniker</th>\n                            <th style="width: 25%;">Bestätigt</th>\n                            <th style="width: 25%;"></th>\n                        </tr>\n                    </thead>\n                    <tbody id="techniciansList">\n                    </tbody>\n                </table>\n                <button type="button" class="btn btn-sm btn-success" id="addTechnicianBtn">\n                    <i class="ti-plus"></i> Techniker hinzufügen\n                </button>\n            </div>\n\n            <div class="mb-3 mt-3">\n                <div class="form-check">\n                    <input type="checkbox" class="form-check-input" id="assignVolunteersCheckbox">\n                    <label class="form-check-label fw-bold" for="assignVolunteersCheckbox">\n                        Volunteers zuweisen\n                    </label>\n                </div>\n            </div>\n\n            <div id="volunteersContainer" style="display: none;">\n                <table class="table table-bordered table-sm">\n                    <thead>\n                        <tr>\n                            <th style="width: 35%;">Volunteer</th>\n                            <th style="width: 20%;">Bestätigt</th>\n                            <th style="width: 35%;">Aufgaben</th>\n                            <th style="width: 10%;"></th>\n                        </tr>\n                    </thead>\n                    <tbody id="volunteersList">\n                    </tbody>\n                </table>\n                <button type="button" class="btn btn-sm btn-success" id="addVolunteerBtn">\n                    <i class="ti-plus"></i> Volunteer hinzufügen\n                </button>\n            </div>\n        </div>\n    '}(),Y();break;case"cleaning":a.innerHTML=(t=window.dashboardData.allCleanings||[],'\n        <div class="border-top pt-3 mt-3">\n            <h6 class="fw-bold mb-3">Reinigungs-Details</h6>\n\n            <div class="mb-3">\n                <label for="cleaningSelect" class="form-label">Reinigung</label>\n                <select class="form-select" id="cleaningSelect">\n                    <option value="">Bitte wählen...</option>\n                    '.concat(t.map(function(e){return'<option value="'.concat(e.id,'">').concat(e.name,"</option>")}).join(""),"\n                </select>\n            </div>\n        </div>\n    "))}}}function Y(){var e=document.getElementById("assignTechniciansCheckbox"),t=document.getElementById("techniciansContainer"),n=document.getElementById("addTechnicianBtn");e&&t&&e.addEventListener("change",function(){t.style.display=this.checked?"block":"none"}),n&&n.addEventListener("click",q);var a=document.getElementById("assignVolunteersCheckbox"),i=document.getElementById("volunteersContainer"),r=document.getElementById("addVolunteerBtn");a&&i&&a.addEventListener("change",function(){i.style.display=this.checked?"block":"none"}),r&&r.addEventListener("click",N)}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=window.dashboardData.allTechnicians||[],n=document.getElementById("techniciansList");if(n){var a=document.createElement("tr"),i="tech_"+Date.now()+"_"+Math.random().toString(36).substr(2,9);a.dataset.rowId=i,a.innerHTML='\n        <td>\n            <select class="form-select form-select-sm technician-select" data-row-id="'.concat(i,'">\n                <option value="">Wählen...</option>\n                ').concat(t.map(function(t){return'\n                    <option value="'.concat(t.id,'" ').concat(e&&e.id==t.id?"selected":"",">\n                        ").concat(t.name,"\n                    </option>\n                ")}).join(""),'\n            </select>\n        </td>\n        <td class="text-center">\n            <input type="checkbox" class="form-check-input technician-confirmed"\n                   data-row-id="').concat(i,'"\n                   ').concat(e&&e.confirmed?"checked":"",'>\n        </td>\n        <td class="text-center">\n            <button type="button" class="btn btn-sm btn-danger remove-technician-btn" data-row-id="').concat(i,'">\n                <i class="ti-trash"></i>\n            </button>\n        </td>\n    '),n.appendChild(a),a.querySelector(".remove-technician-btn").addEventListener("click",function(){a.remove()})}}function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=window.dashboardData.allVolunteers||[],n=document.getElementById("volunteersList");if(n){var a=document.createElement("tr"),i="vol_"+Date.now()+"_"+Math.random().toString(36).substr(2,9);a.dataset.rowId=i;var r=Object.entries(D).map(function(t){var n=m(t,2),a=n[0],r=n[1],o=e&&e.tasks&&e.tasks.includes(a)?"checked":"";return'\n            <div class="form-check form-check-inline">\n                <input class="form-check-input volunteer-task" type="checkbox"\n                       value="'.concat(a,'"\n                       data-row-id="').concat(i,'"\n                       ').concat(o,'>\n                <label class="form-check-label" style="font-size: 0.85rem;">').concat(r,"</label>\n            </div>\n        ")}).join("");a.innerHTML='\n        <td>\n            <select class="form-select form-select-sm volunteer-select" data-row-id="'.concat(i,'">\n                <option value="">Wählen...</option>\n                ').concat(t.map(function(t){return'\n                    <option value="'.concat(t.id,'" ').concat(e&&e.id==t.id?"selected":"",">\n                        ").concat(t.name,"\n                    </option>\n                ")}).join(""),'\n            </select>\n        </td>\n        <td class="text-center">\n            <input type="checkbox" class="form-check-input volunteer-confirmed"\n                   data-row-id="').concat(i,'"\n                   ').concat(e&&e.confirmed?"checked":"",">\n        </td>\n        <td>\n            ").concat(r,'\n        </td>\n        <td class="text-center">\n            <button type="button" class="btn btn-sm btn-danger remove-volunteer-btn" data-row-id="').concat(i,'">\n                <i class="ti-trash"></i>\n            </button>\n        </td>\n    '),n.appendChild(a),a.querySelector(".remove-volunteer-btn").addEventListener("click",function(){a.remove()})}}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=document.getElementById("appointmentModalLabel"),r=document.getElementById("deleteAppointmentBtn"),o=document.getElementById("appointmentRoom"),c=document.getElementById("appointmentTitle"),s=document.getElementById("appointmentDescription"),l=document.getElementById("appointmentDateRange"),m=document.getElementById("appointmentAllDay"),v=document.getElementById("appointmentRecurring");o&&(o.value=""),c&&(c.value=""),s&&(s.value=""),m&&(m.checked=!1),v&&(v.checked=!1),document.getElementById("recurrenceOptions").style.display="none";var h=document.getElementById("typePrivate");h&&(h.checked=!0,C());var f=(0,u.qR)(l,"dateTimeRange");if(t){var b,y,g;i.textContent="Termin bearbeiten",r.style.display="inline-block";var k=String(t.id),E=k;k.includes("_")&&(E=k.split("_")[1]),document.getElementById("appointmentId").value=E;var j=(null===(b=t.extendedProps)||void 0===b?void 0:b.originalTitle)||t.title;c&&(c.value=j),s&&(s.value=(null===(y=t.extendedProps)||void 0===y?void 0:y.description)||""),t.extendedProps&&t.extendedProps.roomId&&o&&(o.value=t.extendedProps.roomId);var w=(null===(g=t.extendedProps)||void 0===g?void 0:g.appointmentType)||"private",D=document.querySelector('input[name="appointmentType"][value="'.concat(w,'"]'));D&&(D.checked=!0,C());var T=d()(t.start),I=d()(t.end||t.start);t.allDay&&I.subtract(1,"days"),f.setStartDate(T),f.setEndDate(I),m&&(m.checked=t.allDay),z({target:{checked:t.allDay}}),setTimeout(function(){!function(e){var t,n=null===(t=e.extendedProps)||void 0===t?void 0:t.appointmentType;if("production"===n||"closed_event"===n){var a,i,r,o,c;if("production"===n&&null!==(a=e.extendedProps)&&void 0!==a&&a.productionId){var s=document.getElementById("productionSelect");s&&(s.value=e.extendedProps.productionId)}if(null!==(i=e.extendedProps)&&void 0!==i&&i.eventType){var l=document.querySelector('input[name="eventType"][value="'.concat(e.extendedProps.eventType,'"]'));l&&(l.checked=!0)}if(null!==(r=e.extendedProps)&&void 0!==r&&r.status){var d=document.querySelector('input[name="appointmentStatus"][value="'.concat(e.extendedProps.status,'"]'));d&&(d.checked=!0)}var u,m=document.getElementById("internalTechniciansAttending");if(m)m.checked=(null===(u=e.extendedProps)||void 0===u?void 0:u.internalTechniciansAttending)||!1;if(null!==(o=e.extendedProps)&&void 0!==o&&o.technicians&&e.extendedProps.technicians.length>0){var v=document.getElementById("assignTechniciansCheckbox");v&&(v.checked=!0,v.dispatchEvent(new Event("change"))),setTimeout(function(){e.extendedProps.technicians.forEach(function(e){q(e)})},100)}if(null!==(c=e.extendedProps)&&void 0!==c&&c.volunteers&&e.extendedProps.volunteers.length>0){var p=document.getElementById("assignVolunteersCheckbox");p&&(p.checked=!0,p.dispatchEvent(new Event("change"))),setTimeout(function(){e.extendedProps.volunteers.forEach(function(e){N(e)})},100)}}else if("cleaning"===n){var h;if(null!==(h=e.extendedProps)&&void 0!==h&&h.cleaningId){var f=document.getElementById("cleaningSelect");f&&(f.value=e.extendedProps.cleaningId)}}}(t)},100)}else{var S,B;i.textContent="Neuer Termin",r.style.display="none",document.getElementById("appointmentId").value="",a&&o&&(o.value=a),n?(S=d()(n),B=d()(n).add(1,"hours"),m&&(m.checked=!1)):((S=e?d()(e):d()()).hours(9).minutes(0).seconds(0),B=d()(S).add(1,"hours"),m&&(m.checked=!1)),f.setStartDate(S),f.setEndDate(B),z({target:{checked:!1}})}p&&p.show()}function z(e){var t=document.getElementById("appointmentDateRange");if(t){var n=(0,u.IQ)(t);if(n){if(e.target.checked){var a=n.startDate,i=n.endDate;n.timePicker=!1,n.locale.format="DD.MM.YYYY",n.setStartDate(a.startOf("day")),n.setEndDate(i.startOf("day"))}else n.timePicker=!0,n.timePicker24Hour=!0,n.timePickerIncrement=15,n.locale.format="DD.MM.YYYY HH:mm";n.updateView()}}}function H(){var e=document.getElementById("appointmentId").value,t=document.getElementById("appointmentTitle").value,n=document.getElementById("appointmentDescription").value,a=document.getElementById("appointmentRoom")?document.getElementById("appointmentRoom").value:null,i=document.querySelector('input[name="appointmentType"]:checked'),r=i?i.value:"private";if(t){var o=document.getElementById("appointmentAllDay").checked,c=document.getElementById("appointmentDateRange"),s=(0,u.IQ)(c);if(s&&s.startDate&&s.endDate){var l,d,m=s.startDate,v=s.endDate;o?(l=m.format("YYYY-MM-DD")+"T00:00:00",d=v.clone().add(1,"days").format("YYYY-MM-DD")+"T00:00:00"):(l=m.format("YYYY-MM-DDTHH:mm:ss"),d=v.format("YYYY-MM-DDTHH:mm:ss"));var h={title:t,description:n,start:l,end:d,allDay:o,roomId:a,type:r};if("production"===r){var f=document.getElementById("productionSelect");h.productionId=f?f.value:null;var b=document.querySelector('input[name="eventType"]:checked');h.eventType=b?b.value:null;var k=document.querySelector('input[name="appointmentStatus"]:checked');h.status=k?k.value:null;var E=document.getElementById("internalTechniciansAttending");h.internalTechniciansAttending=!!E&&E.checked,h.technicians=O(),h.volunteers=V()}else if("closed_event"===r){var j=document.querySelector('input[name="eventType"]:checked');h.eventType=j?j.value:null;var w=document.querySelector('input[name="appointmentStatus"]:checked');h.status=w?w.value:null;var D=document.getElementById("internalTechniciansAttending");h.internalTechniciansAttending=!!D&&D.checked,h.technicians=O(),h.volunteers=V()}else if("cleaning"===r){var I=document.getElementById("cleaningSelect");h.cleaningId=I?I.value:null}var S=document.getElementById("appointmentRecurring");if(S&&S.checked){var B=document.getElementById("recurrenceFrequency"),L=document.getElementById("recurrenceEndDate");if(B&&(h.recurrenceFrequency=B.value),L){var A=(0,u.IQ)(L);A&&A.startDate&&(h.recurrenceEndDate=A.startDate.format("YYYY-MM-DD"))}if(!h.recurrenceEndDate)return void alert("Bitte geben Sie ein Enddatum für die Wiederholung an.")}var P=e?"/appointment/".concat(e,"/edit"):"/appointment/create";fetch(P,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}).then(function(e){return e.json()}).then(function(e){e.success?(p.hide(),M(),fetch("/appointments/all").then(function(e){return e.json()}).then(function(e){y=e,T(g,e)}),x("success","Termin erfolgreich gespeichert")):alert("Fehler beim Speichern: "+(e.message||"Unbekannter Fehler"))}).catch(function(e){console.error(e),alert("Fehler beim Speichern.")})}else alert("Bitte wählen Sie einen Zeitraum aus.")}else alert("Bitte geben Sie einen Titel ein.")}function O(){var e=document.querySelectorAll("#techniciansList tr"),t=[];return e.forEach(function(e){var n=e.dataset.rowId,a=e.querySelector('.technician-select[data-row-id="'.concat(n,'"]')),i=e.querySelector('.technician-confirmed[data-row-id="'.concat(n,'"]'));a&&a.value&&t.push({id:a.value,confirmed:!!i&&i.checked})}),t}function V(){var e=document.querySelectorAll("#volunteersList tr"),t=[];return e.forEach(function(e){var n=e.dataset.rowId,a=e.querySelector('.volunteer-select[data-row-id="'.concat(n,'"]')),i=e.querySelector('.volunteer-confirmed[data-row-id="'.concat(n,'"]')),r=e.querySelectorAll('.volunteer-task[data-row-id="'.concat(n,'"]:checked'));if(a&&a.value){var o=Array.from(r).map(function(e){return e.value});t.push({id:a.value,confirmed:!!i&&i.checked,tasks:o})}}),t}function F(e){I=e;var t=document.getElementById("deleteConfirmMessage"),n=document.getElementById("deleteRecurringOptions");e?(n.style.display="block",t.textContent="Möchten Sie diesen Termin löschen?"):(n.style.display="none",t.textContent="Möchten Sie diesen Termin wirklich löschen?"),b&&b.show()}function _(){if(I){var e=document.querySelector('input[name="deleteMode"]:checked'),t=e?e.value:"single",n=String(I),a=n;n.includes("_")&&(a=n.split("_")[1]),fetch("/appointment/".concat(a,"/delete"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:t})}).then(function(e){return e.json()}).then(function(e){e.success?(b&&b.hide(),p&&p._isShown&&p.hide(),M(),fetch("/appointments/all").then(function(e){return e.json()}).then(function(e){y=e,T(g,e)}),x("success","Termin erfolgreich gelöscht")):alert("Fehler beim Löschen.")}).catch(function(e){console.error(e),alert("Fehler beim Löschen.")})}}function G(e){var t=document.querySelector('.key-item-btn[data-key-id="'.concat(e,'"]'));t||(t=e);var n=t.dataset.keyId,a=t.dataset.keyName,i=t.dataset.keyStatus,r=document.getElementById("keyId");r&&(r.value=n);var o=document.getElementById("modalKeyNameTitle");o&&(o.textContent=a);var c=document.getElementById("keyStatus");c&&(c.value=i,c.dispatchEvent(new Event("change")));var s=document.getElementById("keyBorrowDate"),l=document.getElementById("keyReturnDate");if(s){var m=(0,u.qR)(s,"singleDateTime"),v=t.dataset.borrowDate;v&&m&&m.setStartDate(d()(v))}if(l){var p=(0,u.qR)(l,"singleDateTime"),h=t.dataset.returnDate;h&&p&&p.setStartDate(d()(h))}var b=t.dataset.userId,y=t.dataset.techId,g=t.dataset.prodId,k=t.dataset.cleanId,E=document.getElementById("borrowerType");if(E){var j=document.getElementById("userId");j&&(j.value="");var w=document.getElementById("technicianId");w&&(w.value="");var D=document.getElementById("productionId");D&&(D.value="");var T=document.getElementById("cleaningId");T&&(T.value=""),b&&j?(E.value="user",j.value=b):y&&w?(E.value="technician",w.value=y):g&&D?(E.value="production",D.value=g):k&&T?(E.value="cleaning",T.value=k):E.value="",E.dispatchEvent(new Event("change"))}f&&f.show()}function W(){var e=document.getElementById("keyId"),t=document.getElementById("keyStatus");if(e&&t){var n=e.value,a=t.value,i=function(e){var t=document.getElementById(e);return t?t.value:null},r=document.getElementById("keyBorrowDate"),o=document.getElementById("keyReturnDate"),c=null,s=null;if(r){var l=(0,u.IQ)(r);l&&l.startDate&&(c=l.startDate.format("YYYY-MM-DD HH:mm:ss"))}if(o){var d=(0,u.IQ)(o);d&&d.startDate&&(s=d.startDate.format("YYYY-MM-DD HH:mm:ss"))}var m={status:a,userId:i("userId"),technicianId:i("technicianId"),productionId:i("productionId"),cleaningId:i("cleaningId"),borrowDate:c,returnDate:s};fetch("/dashboard/key/".concat(n,"/update"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(function(e){e.ok?(f.hide(),window.location.reload()):alert("Fehler beim Speichern")}).catch(function(e){return console.error(e)})}}function U(){S(),function(){var e=document.getElementById("keyManagementModal");if(e){f=new s.aF(e),document.querySelectorAll(".key-item-btn").forEach(function(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("click",function(){G(this)})});var t=document.getElementById("keyStatus");if(t){var n=t.cloneNode(!0);t.parentNode.replaceChild(n,t),n.addEventListener("change",function(){var e=document.getElementById("borrowDetails");"borrowed"===this.value?e&&(e.style.display="block"):e&&(e.style.display="none")})}var a=document.getElementById("borrowerType");if(a){var i=a.cloneNode(!0);a.parentNode.replaceChild(i,a),i.addEventListener("change",function(){if(document.querySelectorAll(".borrower-select").forEach(function(e){return e.style.display="none"}),this.value){var e=this.value+"SelectDiv",t=document.getElementById(e);t&&(t.style.display="block")}})}var r=document.getElementById("saveKeyBtn");if(r){var o=r.cloneNode(!0);r.parentNode.replaceChild(o,r),o.addEventListener("click",W)}}}()}document.addEventListener("DOMContentLoaded",U),document.addEventListener("turbo:load",U),document.addEventListener("turbo:render",U),document.addEventListener("turbo:visit",U)}},e=>{e.O(0,[576,214],()=>{return t=70001,e(e.s=t);var t});e.O()}]);